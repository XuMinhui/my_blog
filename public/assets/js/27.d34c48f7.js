(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{600:function(s,n,a){"use strict";a.r(n);var t=a(2),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",[s._v("第一次使用Nginx 反向代理技术是在学校安排两周的‘南昌朝腾教育’校外实训期间，对当时java实训项目—超市管理系统，进行了node重构之后部署遇到了需要反向代理的情景。")])]),s._v(" "),a("h2",{attrs:{id:"一、初识-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、初识-nginx"}},[s._v("#")]),s._v(" 一、初识 Nginx")]),s._v(" "),a("h3",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("什么是 Nginx")])]),s._v(" "),a("ul",[a("li",[s._v("Nginx是一款轻量级的Web服务器、反向代理服务器，由于它的内存占用少，启动极快，高并发能力强，在互联网项目中广泛应用。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("正向代理")])]),s._v(" "),a("ul",[a("li",[s._v("比如翻墙，Vpn代理")]),s._v(" "),a("li",[s._v("由于防火墙的原因，我们并不能直接访问谷歌，那么我们可以借助VPN来实现，这就是一个简单的正向代理的例子。这里你能够发现，正向代理“代理”的是客户端，而且客户端是知道目标的，而目标是不知道客户端是通过VPN访问的。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("反向代理")])]),s._v(" "),a("ul",[a("li",[s._v("比如资源镜像")]),s._v(" "),a("li",[s._v("当我们在外网访问百度的时候，其实会进行一个转发，代理到内网去，这就是所谓的反向代理，即反向代理“代理”的是服务器端，而且这一个过程对于客户端而言是透明的。")])])])]),s._v(" "),a("h2",{attrs:{id:"二、安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、安装-nginx"}},[s._v("#")]),s._v(" 二、安装 Nginx")]),s._v(" "),a("h3",{attrs:{id:"windows-环境下安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-环境下安装"}},[s._v("#")]),s._v(" windows 环境下安装")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("1、下载 Nginx")])])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://nginx.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载地址"),a("OutboundLink")],1),s._v("  -"),a("code",[s._v("http://nginx.org")])]),s._v(" "),a("ul",[a("li",[s._v("解压后如下图所示")])])]),s._v(" "),a("li",[a("p",[a("img",{attrs:{src:"C:%5CUsers%5C%E5%80%9A%E5%A4%A9%E6%83%8A%E9%B8%BF%E7%BD%91%E7%BB%9C%E4%B8%B6%E7%B4%AB%E7%82%AB%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191201180007712.png",alt:"image-20191201180007712"}})])])]),s._v(" "),a("h3",{attrs:{id:"windows-中配置-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-中配置-nginx"}},[s._v("#")]),s._v(" windows 中配置 Nginx")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("找到 conf 目录里的 nginx.conf 文件，配置Nginx")])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://blog.csdn.net/kingscoming/article/details/79042874",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置文件详解"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("3.1 主要配置 Server")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("server 可以配置多个")])]),s._v(" "),a("li",[a("p",[s._v("举例：")]),s._v(" "),a("p",[s._v("http {")]),s._v(" "),a("p",[s._v("​    #静态文件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("如此访问 http://static.com 即可访问到 D:/source\n")])])]),a("p",[s._v("​    server {")]),s._v(" "),a("p",[s._v("​        listen       80;")]),s._v(" "),a("p",[s._v("​        server_name  static.com;")]),s._v(" "),a("p",[s._v("​        location / {")]),s._v(" "),a("p",[s._v("​            root   D:/source ;")]),s._v(" "),a("p",[s._v("​        }")]),s._v(" "),a("p",[s._v("​    }")]),s._v(" "),a("p",[s._v("​    #html文件")])])]),s._v(" "),a("p",[s._v("​    如此访问 127.0.0.1 或 localhost 即可访问 index.html index.htm")]),s._v(" "),a("p",[s._v("​    server {")]),s._v(" "),a("p",[s._v("​        listen       80;")]),s._v(" "),a("p",[s._v("​        server_name  127.0.0.1 localhost;")]),s._v(" "),a("p",[s._v("​        location / {")]),s._v(" "),a("p",[s._v("​            root   D:/source ;")]),s._v(" "),a("p",[s._v("​            index  index.html index.htm;")]),s._v(" "),a("p",[s._v("​        }")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v(" }\n")])])]),a("p",[s._v("}")]),s._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("超市管理系统实例参数\n\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server_name  sp.zixuan2018.cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#charset utf8;")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#access_log  logs/host.access.log  main;")]),s._v("\n\n        location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            proxy_pass       http://127.0.0.1:3000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("            \n\t    \tproxy_set_header Host      "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \t    \tproxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])])])])]),s._v(" "),a("h2",{attrs:{id:"三、常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、常用命令"}},[s._v("#")]),s._v(" 三、常用命令")]),s._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("验证配置是否正确: \nnginx -t\n\n查看Nginx的版本号：\nnginx -V\n\n启动Nginx：\nstart nginx\n\n快速停止或关闭Nginx：\nnginx -s stop\n\n正常停止或关闭Nginx：\nnginx -s quit\n\n配置文件修改重装载命令：\nnginx -s reload\n\n测试nginx配置文件是否正确:\nnginx -t -c /path/to/nginx.conf \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("启动后如何检查是否启动成功呢？")])])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v('输入命令\ntasklist /fi "imagename eq nginx.exe\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"四、常见错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、常见错误"}},[s._v("#")]),s._v(" 四、常见错误")]),s._v(" "),a("h3",{attrs:{id:"_1-端口占用问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-端口占用问题"}},[s._v("#")]),s._v(" 1. 端口占用问题")]),s._v(" "),a("ul",[a("li",[s._v("我的配置文件里服务侦听的是 80 端口，由于机器上部署了IIS，80端口被默认站点占用，把站点关闭就可以了，这个问题在错误日志里记录是这样的。")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("/01/15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":44:12 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("emerg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8800")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5988: bind() to 0.0.0.0:80 failed (10013: An attempt was made to access a socket in a way forbidden by its access permissions)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("碰到类似的错误，请确认端口是否被占用或被防火墙屏蔽")])]),s._v(" "),a("h3",{attrs:{id:"_2-nginx所在目录有中文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-nginx所在目录有中文"}},[s._v("#")]),s._v(" 2. Nginx所在目录有中文")]),s._v(" "),a("ul",[a("li",[s._v("错误日志大致输出一下内容")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("/01/15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":55:55 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("emerg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5664")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#8528: CreateFile() "E:\\软件\\nginx-1.7.8/conf/nginx.conf" failed (1113: No mapping for the Unicode character exists in the target multi-byte code page)')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-缺少nginx-pid文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-缺少nginx-pid文件"}},[s._v("#")]),s._v(" 3. 缺少nginx.pid文件")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("解决方法")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用命令或手动创建 "),a("code",[s._v("/logs/nginx.pid")]),s._v("文件:")]),s._v(" "),a("p",[s._v("nginx -c conf/nginx.conf")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("nginx: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" CreateFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"E:'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("ginx"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('ginx-1.9.3/logs/nginx.pid"')]),s._v(" failed\n\nnginx: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" CreateFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"E:'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("ginx"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('ginx-1.9.3/logs/nginx.pid"')]),s._v(" failed\n\nnginx: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Open"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"E:'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("ginx"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('ginx-1.9.3/logs/nginx.pid"')]),s._v(" failed\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"_4-进程无效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-进程无效"}},[s._v("#")]),s._v(" 4. 进程无效")]),s._v(" "),a("p",[s._v("注意不要直接双击nginx.exe，这样会导致修改配置后重启、停止nginx无效，需要手动关闭任务管理器内的所有nginx进程")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"五、（推荐）宝塔使用-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、（推荐）宝塔使用-nginx"}},[s._v("#")]),s._v(" 五、（推荐）宝塔使用 Nginx")]),s._v(" "),a("blockquote",[a("p",[s._v("对于前端开发人员来说，很多时候我们使用Nginx 仅仅是为了解决反向代理端口问题，比如写了一个node 项目，默认运行在localhost:3000，我们可以使用Nginx 实现域名绑定，直接访问域名及相当于内部访问localhost:3000。自己安装配置Nginx 太麻烦了，我们可以有更省力省心的方法")])]),s._v(" "),a("h3",{attrs:{id:"安装软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装软件"}},[s._v("#")]),s._v(" 安装软件")]),s._v(" "),a("p",[s._v("安装宝塔，这里不做赘述，好几篇文章中提到了怎么安装。就跟安装软件一样的，实在不会"),a("a",{attrs:{href:"http://baidu.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度一下"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("安装Nginx，在软件商店搜索安装，这里也不做赘述，安装好了就会有这个面板菜单")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://oss.yitian2019.cn/img/image-20200622151651383.png",alt:"image-20200622151651383"}})]),s._v(" "),a("p",[s._v("如果的确安装了，但是首页面板没显示需要打开首页展示选项")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://oss.yitian2019.cn/img/image-20200622151459037.png",alt:"image-20200622151459037"}})]),s._v(" "),a("h3",{attrs:{id:"可视化使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可视化使用"}},[s._v("#")]),s._v(" 可视化使用")]),s._v(" "),a("h4",{attrs:{id:"全局使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局使用"}},[s._v("#")]),s._v(" 全局使用")]),s._v(" "),a("p",[s._v("可以在首页面板中点击修改配置，这里修改的是全局配置")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://oss.yitian2019.cn/img/image-20200622151800628.png",alt:"image-20200622151800628"}})]),s._v(" "),a("h4",{attrs:{id:"站点配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#站点配置"}},[s._v("#")]),s._v(" 站点配置")]),s._v(" "),a("p",[s._v("在对应的站点上也能对站点进行配置，建议在这里修改较为妥当")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://oss.yitian2019.cn/img/image-20200622152616123.png",alt:"image-20200622152616123"}})]),s._v(" "),a("p",[s._v("如果不了解配置规则，则可以按下面操作设置添加反向代理")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://oss.yitian2019.cn/img/image-20200622152810789.png",alt:"image-20200622152810789"}})]),s._v(" "),a("p",[s._v("如果是node项目，建议可以使用"),a("code",[s._v("PM2管理器")]),s._v("来部署项目")])])}),[],!1,null,null,null);n.default=e.exports}}]);